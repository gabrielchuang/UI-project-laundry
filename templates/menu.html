<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Laundry Basics Course</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        :root {
            --primary: #0047AB;
            --primary-light: #3a75c4;
            --primary-dark: #003384;
            --secondary: #FFD700;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --gray-dark: #495057;
        }

        body {
            font-family: 'Roboto', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f7fa;
            margin: 0;
            padding: 0;
        }

        .navbar {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 1rem 2rem;
            margin-bottom: 2rem;
        }

        .navbar-brand {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
        }

        .navbar-brand:before {
            content: "‚≠ê";
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .course-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .intro-panel {
            background-color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .module-timeline-container {
            padding: 1rem;
        }

        .module-row {
            position: relative;
        }

        .timeline-node-container {
            position: relative;
            width: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timeline-node {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--gray-light);
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .timeline-node.completed {
            background-color: var(--success);
        }

        .timeline-node.active {
            background-color: var(--warning);
            animation: pulse 2s infinite;
        }

        .timeline-node.locked {
            background-color: var(--gray-light);
        }

        .timeline-line {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 60px;
            background-color: var(--gray-light);
            z-index: 1;
        }

        .module-btn {
            flex-grow: 1;
            padding: 1rem 1.5rem;
            text-align: left;
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--dark);
            background-color: white;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .module-btn.completed {
            border-color: var(--success);
            background-color: rgba(40, 167, 69, 0.1);
        }

        .module-btn.completed:before {
            content: "‚úì ";
            color: var(--success);
        }

        .module-btn.active {
            border-color: var(--warning);
            background-color: rgba(0, 71, 171, 0.05);
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 71, 171, 0.15);
        }

        .module-btn.locked {
            border-color: var(--gray-light);
            background-color: var(--gray-light);
            color: var(--gray);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .module-btn.locked:before {
            content: "üîí ";
            color: var(--gray);
        }

        .module-btn:hover:not(.locked) {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 71, 171, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(0, 71, 171, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 71, 171, 0);
            }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .course-container {
                padding: 1rem;
            }

            .intro-panel {
                padding: 1.5rem;
            }

            .module-btn {
                font-size: 1rem;
                padding: 0.8rem 1.2rem;
            }
        }
    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Five Star Laundromat</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#" id="home-link">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" id="quiz-link">Current Module</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="course-container">
    <!-- Introduction Panel -->
    <div class="intro-panel">
        <h1 class="text-center mb-4">Welcome to the Laundry Basics course!</h1>
        <p class="lead">This course is designed to help you learn the fundamentals of laundry care. By the end of this course, you'll be able to sort your laundry, choose the right wash settings, and understand how to read clothing labels.</p>
    </div>

    <!-- Course Content Layout -->
    <div class="course-content">
        <!-- Timeline and Module Buttons -->
        <div class="module-timeline-container">
            <div class="module-row d-flex align-items-center mb-4">
                <div class="timeline-node-container me-4">
                    <div class="timeline-node" id="node-1"></div>
                    <div class="timeline-line"></div>
                </div>
                <button class="module-btn" id="module-1" data-module-id="sorting-mainpage">
                    Sorting your laundry
                </button>
            </div>

            <div class="module-row d-flex align-items-center mb-4">
                <div class="timeline-node-container me-4">
                    <div class="timeline-node" id="node-2"></div>
                    <div class="timeline-line"></div>
                </div>
                <button class="module-btn" id="module-2" data-module-id="wash-settings-mainpage">
                    Wash settings
                </button>
            </div>

            <div class="module-row d-flex align-items-center mb-4">
                <div class="timeline-node-container me-4">
                    <div class="timeline-node" id="node-3"></div>
                    <div class="timeline-line"></div>
                </div>
                <button class="module-btn" id="module-3" data-module-id="reading-labels-mainpage">
                    Reading labels
                </button>
            </div>

            <div class="module-row d-flex align-items-center mb-4">
                <div class="timeline-node-container me-4">
                    <div class="timeline-node" id="node-4"></div>
                </div>
                <button class="module-btn" id="module-4" data-module-id="final-quiz-mainpage">
                    Final Quiz
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    $(document).ready(function () {
        // Define module progression requirements
        const moduleRequirements = {
            'sorting-mainpage': null, // First module, no requirements
            'wash-settings-mainpage': ['sorting-soil-main'], // Requires sorting-soil-main completion
            'reading-labels-mainpage': ['wash-settings-mainpage'], // Requires wash settings completion
            'final-quiz-mainpage': ['reading-labels-mainpage'] // Requires reading labels completion
        };

        // Get completed modules from localStorage
        let completedModules = JSON.parse(localStorage.getItem('completedModules')) || [];

        // Function to check if a module should be unlocked
        function checkModuleUnlocked(moduleId) {
            // First module is always unlocked
            if (!moduleRequirements[moduleId]) return true;

            // Check if all required modules are completed
            return moduleRequirements[moduleId].every(requiredId =>
                completedModules.includes(requiredId)
            );
        }

        // Function to update UI based on completed modules
        function updateModuleStatus() {
            $('.module-btn').each(function (index) {
                const $btn = $(this);
                const $node = $('#node-' + (index + 1));
                const moduleId = $btn.data('module-id');

                if (completedModules.includes(moduleId)) {
                    // Completed modules
                    $btn.addClass('completed').removeClass('active locked');
                    $node.addClass('completed').removeClass('active locked');
                } else if (checkModuleUnlocked(moduleId)) {
                    // Active (unlocked) module
                    $btn.addClass('active').removeClass('completed locked');
                    $node.addClass('active').removeClass('completed locked');
                } else {
                    // Locked modules
                    $btn.addClass('locked').removeClass('completed active');
                    $node.addClass('locked').removeClass('completed active');
                }
            });
        }

        // Handle module button clicks
        $('.module-btn').on('click', function () {
            const moduleId = $(this).data('module-id');

            if ($(this).hasClass('locked')) {
                // Get the requirement module name
                const requirementId = moduleRequirements[moduleId][0];
                let requirementName = requirementId;

                // Map special cases to user-friendly names
                if (requirementId === 'sorting-soil-main') {
                    requirementName = "Sorting by Soil Level";
                } else if (requirementId === 'wash-settings-mainpage') {
                    requirementName = "Wash Settings module";
                } else if (requirementId === 'reading-labels-mainpage') {
                    requirementName = "Reading Labels module";
                }

                alert(`Please complete the "${requirementName}" first!`);
                return;
            }

            window.location.href = `/page/${moduleId}`;
        });

        // Handle navbar links
        $('#home-link').on('click', function (e) {
            e.preventDefault();
            window.location.href = '/';
        });

        $('#quiz-link').on('click', function (e) {
            e.preventDefault();
            // Find the first unlocked (active) module and navigate to it
            const $activeModule = $('.module-btn.active').first();
            if ($activeModule.length) {
                $activeModule.click();
            } else {
                // If all completed, go to final quiz
                window.location.href = '/page/final-quiz-mainpage';
            }
        });

        // Add function to mark module as completed (called when returning from a quiz)
        window.markModuleComplete = function (moduleId) {
            if (!completedModules.includes(moduleId)) {
                completedModules.push(moduleId);
                localStorage.setItem('completedModules', JSON.stringify(completedModules));
                updateModuleStatus();
            }
        };

        // Check URL parameters to see if we're returning from a completed quiz
        const urlParams = new URLSearchParams(window.location.search);
        const completedModule = urlParams.get('completed');
        if (completedModule) {
            markModuleComplete(completedModule);
            // Remove the parameter from URL to prevent duplicate completions on refresh
            window.history.replaceState({}, document.title, window.location.pathname);

            // Check if special modules should also be marked completed
            // For example, completing sorting-soil-main also completes sorting-mainpage
            if (completedModule === 'sorting-soil-main') {
                markModuleComplete('sorting-mainpage');
            }
        }

        // Initialize the UI
        updateModuleStatus();

    });
</script>
</body>
</html>